<!doctype html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!-- Consider adding a manifest.appcache: h5bp.com/d/Offline -->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">

  <title>Listing Pages with WordPress · ClioWeb</title>    
  
  <meta name="author" content="Jeremy Boggs">
  <meta name="robots" content="index,follow">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="/i/icon.png">
  <!-- OpenID -->
  <link rel="openid.server" href="http://openid.clioweb.org/">
  <link rel="openid.delegate" href="http://openid.clioweb.org/">

  <!-- Feeds -->
  <link rel="alternate" type="application/rss+xml" title="Atom" href="/atom.xml">
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml">

  <!-- Style Sheets -->
  <link rel="stylesheet" href="/c/styles.css" type="text/css">
  

  <!-- Typekit -->
  <script src="http://use.typekit.com/fsi3pmz.js"></script>
  <script>try {Typekit.load();}catch(e){}</script>

  <!-- Modernizr -->
  <script src="/j/modernizr.min.js"></script>
  <script>
    Modernizr.load([
      {
        test: Modernizr.mq(),
        nope: ['/j/respond.min.js',
        '/j/selectivizr.min.js']
      }
    ]);
  </script>
</head>

<body class="archive post">
  <header role="banner">

  <h1><a href="/"><img src="/i/watermark.png">ClioWeb</a></h1>

  <nav>
  <ul>
  <li class="nav-about"><a href="/about.html">About</a></li>
  <li class="nav-designing"><a href="/blog.html">Blog</a></li>
  <li class="nav-cv"><a href="/cv.html">CV</a></li>
  <li class="nav-courses"><a href="/courses/">Courses</a></li>
</ul>

  </nav>
  </header>

  <div id="content" role="main">
    
    <article>

  <header>
    <p class="kicker">
      <time datetime="2006-08-24">August 24, 2006</time>
    </p>
    <h1>Listing Pages with WordPress</h1>

  </header>

  <div class="content">

    <p>For you <a href="http://wordpress.org">WordPress</a> geeks out there: I've recently had the need to list the child pages of a particular page <strong>in addition to</strong> listing those same pages once you visit a child page. In this case, I only have <strong>one level of child pages</strong>. So, my page structure looked like this:</p>

<ul>
<li><p>Main Page</p>

<ul>
<li><p>Subpage One</p></li>
<li><p>Subpage Two</p></li>
<li><p>Subpage Three</p></li>
</ul>
</li>
</ul>


<p>You'd want to list the same subpages on <em>both</em> the Main Page and the respective subpages. I came up with a simple solution. First, we need to query the post to get its information. So I set up a PHP variable <code>$page</code> and set it equal to <code>$wp_query-&gt;post;</code>. Then a create another variable called <code>$parent_id</code> and do a database query to get the ID of the <code>$page</code> variable's <code>post_parent</code>. Of course, if <code>$parent_id</code> is empty, then that means the page has no parent, and is thus a Main Page. So, for this case, I throw in a simple <code>if</code> check that will set an empty <code>$parent_id</code> to the page's ID, which is found using <code>$post-&gt;ID</code>. The full script for finding this info, which I put in the <code>&lt;head&gt;</code>, is:</p>

<ol>
<li><p>&lt;?php</p></li>
<li><p>$page = $wp_query->post;</p></li>
<li><p>$parent_id = $wpdb->get_var("SELECT ID FROM $wpdb->posts WHERE ID = '$page->post_parent;'");</p></li>
<li><p>if(!$parent_id) $parent_id = $post->ID;</p></li>
<li><p>?></p></li>
</ol>


<p><strong>Then</strong>, to actually generate the HTML for the page list, I use the following code in the body of my page template:</p>

<ol>
<li><p>&lt;?php if(wp_list_pages("child_of=".$parent_id."&amp;echo=0")): ?></p></li>
<li><p><ul id="subnav"></p></li>
<li><p>&lt;?php</p></li>
<li><p>wp_list_pages("title_li=&amp;child_of=".$parent_id."&amp;depth=1");</p></li>
<li><p>?></p></li>
<li><p></ul></p></li>
<li><p>&lt;?php endif; ?></p></li>
</ol>


<p>In a nutshell, the second part of the script does two things. First, an <code>if</code> statement checks to see if there are in fact subpages for the page's value for <code>$parent_id</code>. That's the <code>&lt;?php if(wp_list_pages("child_of=".$parent_id."&amp;echo=0")): ?&gt;</code> line. So, if a page doesn't have subpages, it won't generate the unordered list. Remember, if the page is a Main Page, <code>$parent_id</code> is the page's ID (see the explanation above). Second, if the first check goes through, then the script will generate the list of pages using the <code>wp_list_pages()</code> WordPress template function, using the <code>$parent_id</code> in its argument for <code>child_of</code>. For more info on how the <code>wp_list_pages()</code> works, see the WordPress Codex page <a href="http://codex.wordpress.org/Template_Tags/wp_list_pages">Template Tags/WP List Pages</a>.</p>

<p>There might be better solutions for this kind of problem, but I thought I'd share it and see if there are ways to improve the scripts. It's working pretty well for me, and I think there are multiple ways to use this kind of page query to make page-specific additions to your site. I do need to come up with a solution for multiple levels of pages (two or more levels deep). If anyone has thoughts on that, please leave a comment!</p>


  </div>

  </article>

  <nav id="post-navigation">
  <ul>
  
  <li class="previous">
    <p class="kicker">Previous Post</p>
      <a href="/2006/08/22/393/" title="Previous Post:
        Katrina's Jewish Voices">Katrina's Jewish Voices</a>
    </li>
  
  
  <li class="next">
    <p class="kicker">Next Post</p>

    <a href="/2006/09/08/the-20-and-odd/" title="next Post:
      The “20 and Odd”">The “20 and Odd”</a>
    </li>
  
  </ul>
  </nav>

  
  </div>
  
  <footer role="contentinfo">
  <div class="info">
    <h2>Info</h2>
    <p>ClioWeb is written and maintained by Jeremy Boggs, since 2004. Content
  licensed under <a
    href="http://creativecommons.org/licenses/by/3.0/">CC-BY</a>.</p>
  </div>
  <div class="contact">
  <h2>Contact</h2>
    <ul>
      <li><a href="mailto:jeremy@clioweb.org">Email</a></li>
      <li><a href="aim:goim?screename=jboggs22">AIM</a></li>
      <li><a href="gtalk:chat?jid=jeremy@clioweb.org">Google Chat</a></li>
    </ul>
  </div>
  <div class="elsewhere">
    <h2>Elsewhere</h2>
    <ul> 
      <li><a href="http://flickr.com/photos/clioweb" class="flickr">Flickr</a></li>
      <li><a href="http://github.com/clioweb" class="github">Github</a></li>
      <li><a href="http://twitter.com/clioweb" class="twitter">Twitter</a></li>
      <li><a href="http://vimeo.com/clioweb" class="vimeo">Vimeo</a></li>
      <li><a href="http://zotero.org/clioweb" class="zotero">Zotero</a></li>
    </ul>
  </div>

  <div class="feeds">
    <h2>Feeds</h2>
    <ul>
      <li><a href="/atom.xml" class="atom">Atom</a></li>
      <li><a href="/rss.xml" class="atom">RSS</a></li>
    </ul>
  </div>
  
  </footer>

  <!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if offline -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="/j/jquery.min.js"><\/script>')</script>

  <script>
    var _gaq=[['_setAccount','UA-341377-1'],['_trackPageview'],['_trackPageLoadTime']];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
    g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>

  <!-- Prompt IE 6 users to install Chrome Frame. Remove this if you want to support IE 6.
       chromium.org/developers/how-tos/chrome-frame-getting-started -->
  <!--[if lt IE 7 ]>
    <script defer src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
    <script defer>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
  <![endif]-->

</body>
</html>

